<!DOCTYPE html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no">
    <title>幸运大转盘</title>
    <link rel="stylesheet" href="./css/style.css" />
    <script src="https://code.jquery.com/jquery-3.0.0.min.js"></script>
    <script src="https://cdn.bootcss.com/mobile-detect/1.3.7/mobile-detect.min.js"></script>
    <script src="https://cdn.bootcss.com/mobile-detect/1.3.7/mobile-detect.js"></script>

</head>

<body>
    <div class="game">
        <div id="pop" style="width: 100%;height: 100%;background: rgba(0,0,0,0.55);position:fixed;z-index: 99;text-align: center;display: none">
            <div id="popBg" class="pop">
                <span id="tips" style="font-size: 18px;color: white;margin: 10px;position: relative;top: 53%">你好阿德</span>
                <img id="confirm" src="img/record.png" style="top: 77%;left:10%;position: absolute;width: 35%">
                <img id="back" src="img/return.png" style="top: 77%;right:10%;position: absolute;width: 35%">
            </div>
        </div>
        <div class="title" style="text-align: center;">
            <img src="img/game-title.png">
        </div>
        <!--<div class="luckDrawCount">你有<span></span>次抽奖机会</div>-->
        <div class="wheel-box">
            <div id="wheel"></div>
            <div id="arrow"></div>
        </div>
        <div style="text-align: center;margin-top: 50px">
            <img id="record" src="img/game-button.png" style="width: 4rem">
        </div>
    </div>
</body>
<script>
    var lotteryConut = 0;
    var userId;
    var ticket;
    _resize();
    window.addEventListener('resize', _resize, false);

    function _resize() {
        var html = document.documentElement;
        var windowWidth = html.clientWidth;
        if (windowWidth > 640) {
            windowWidth = 640;
        }
        html.style.fontSize = windowWidth / 6.4 + 'px';
        loadData()
    }

    function loadData() {
        userId = GetQueryString('userId');
        ticket = GetQueryString('ticket');
        if (userId == "" || ticket == "") {
            alert('请先登录');
            return;
        };
        getCount(userId, ticket);
    };

    function getCount(userId, ticket) {
        $.ajax({
            type: "get",
            dataType: "json",
            async: false,
            url: "http://122.112.237.84:8088/lotteryDraw/auth/getLotteryDrawNum",
            beforeSend: function(request) {
                request.setRequestHeader("userId", userId);
                request.setRequestHeader("ticket", ticket);
            },
            data: {
                type: 1
            },
            success: function(data) {
                if (data.code == '0') {
                    lotteryConut = data.data;
                } else if (data.success == false) {} else {}
            },
            error: function() {
                alert('错误');
            }
        });
    }

    function GetQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
        var r = window.location.search.substr(1).match(reg);
        if (r != null)
            return unescape(r[2]);
        return "";
    }
</script>
<script src="js/game.js"></script>

</html>